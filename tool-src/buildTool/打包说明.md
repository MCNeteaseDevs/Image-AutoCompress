

# 使用

## spec文件修改
- 一般只需要修改`项目配置`部分即可
- shared_tools_files、tool_specific_files 根据实际情况修改即可
- excludes的内容，可以在打包一次后，看_internal目录下，有哪些库是没有用到的，就将这些库往excludes中添加
- 这里没有使用`hook`，实际用不用都差不多。 
    - 用hook则是在hook中处理查找的逻辑
    - 不用hook，则是在实际调用的代码中处理查找逻辑

## 打包运行
- 双击运行`打包.bat`即可
- 等待跑完后，会在同目录下生成dist下生成项目内容

## 将打包好的项目复制到lib目录下
- 先检查`复制到lib.bat`文件中的lib路径是否正确，如果不对则手动修改
- 双击运行`复制到lib.bat`即可
- 会将项目内容复制到../lib下，这样才能在打包MCS时把项目也打包上去



# 研究记录
### pyinstaller打包
- python环境，必须存放在exe同级的_internal目录下，不能修改
    - 这部分逻辑是写死在exe文件逻辑中
    - 需要先运行py虚拟机，才能运行hook文件，所以hook中修改sys.path环境对这一步工作是无效的
- py库倒可能不用存放在_internal下，理论上可用hook重定向sys.path环境，未验证
- 其他内容，如config文件、第三方exe文件，可自由组织目录结构，只需要在代码中改为通过exe运行目录去查找即可
- pyinstaller只能把资源打到_internal目录下，需在打包完成后，再通过其他代码重新组织目录结构

### nuitka打包
- 如果打成单个文件，会比pyinstaller要小
    - pyinstall=105M，nuitka=73M
- 如果打包成一个目录，会比pyinstaller要大
    - 原因：exe本体会变大
    - pyinstaller=10M，nuitka=55M
    - 目录下有些文件可以删除，但没有自动清理
    - 仍然是需要依赖第三方库的文件，所以这些文件对应的内容，无法减小包体大小
- 理论上（包括查询到的资料），这种打包方式，应该会比pyinstaller要小才对
- nuitka会把虚拟机打到exe文件中，所以可以脱离虚拟机文件运行，也不会受到虚拟机的目录结构影响
    - 相应的，exe文件可能会比纯py代码包要大一点
